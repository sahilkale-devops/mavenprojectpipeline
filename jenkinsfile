pipeline
{


agent any
stages
{
    stage("scm checkout")
    {
        steps
        {
            git branch: 'master', url: 'https://github.com/sahilkale-devops/mavenprojectpipeline.git'
        }
    }

stage("compile code")
    {
        steps 
        { 
            withMaven(globalMavenSettingsConfig: '', jdk: 'JDK_home', maven: 'Maven_home', mavenSettingsConfig: '', traceability: true)
         {sh ' mvn compile'}
        
        }
    }

stage("Unit test cases execution")
    {
        steps 
        { 
            withMaven(globalMavenSettingsConfig: '', jdk: 'JDK_home', maven: 'Maven_home', mavenSettingsConfig: '', traceability: true)
         {sh ' mvn test'}
        
        }
    }
stage("Deploy to tomcat server")
    {
        steps 
        {
            sshagent(['Deploy-to-tomcat'])
             {
                sh 'scp -o StrictHostKeyChecking=no webapp/target/webapp.war ec2-user@172.31.95.6 : /usr/share/tomcat/webapps/'
             }
        }
        
        
    }




}


}